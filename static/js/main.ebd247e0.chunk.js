(this["webpackJsonptoken-portfolio"]=this["webpackJsonptoken-portfolio"]||[]).push([[0],{307:function(e,t,a){e.exports=a(548)},323:function(e,t){},325:function(e,t){},414:function(e,t){},416:function(e,t){},548:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(113),o=a.n(c),i=a(9),l=a.n(i),s=a(25),u=a(39),m=a(91),f=a(140),b=a(32),p=(a(157),a(8)),h=a(23),d=a(28),g=a(283),v=a(86),y=a(114),O=a.n(y),j=a(284),k=a(304),x=a(285);var w=Object(x.createDfuseClient)({apiKey:"web_cb1aa3778752bc154d511ba8d5cefc62",network:"mainnet"});function E(e,t,a,n){return S.apply(this,arguments)}function S(){return(S=Object(s.a)(l.a.mark((function e(t,a,n,r){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.stateTablesForScopes(t,n,a,{blockNum:r});case 3:return c=e.sent,e.abrupt("return",c);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var T=function(e,t){for(var a=new Array,n=e.lifecycle.execution_trace.action_traces;n.length>0;){var r=n.shift();t(r)&&a.push(r),Array.isArray(r.inline_traces)&&n.push.apply(n,Object(h.a)(r.inline_traces))}return a.map((function(e){return{blockNumber:e.block_num,timestamp:new Date("".concat(e.block_time,"Z")),account:e.act.account,name:e.act.name,data:e.act.data,print:e.console,trxId:e.trx_id,globalSequence:Number.parseInt(String(e.receipt.global_sequence),10),receiveSequence:Number.parseInt(String(e.receipt.recv_sequence),10),actDigest:e.receipt.act_digest}}))};function N(e,t,a){return B.apply(this,arguments)}function B(){return(B=Object(k.a)(l.a.mark((function e(t,a,n){var r,c,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c="";case 1:return e.prev=1,e.next=4,Object(j.a)(Promise.race([new Promise((function(e,t){setTimeout((function(){t(new Error("searchTransactions took too long."))}),2e4)})),w.searchTransactions(t,{limit:10,sort:"desc",cursor:c})]));case 4:r=e.sent,e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(1),o=e.t0.message,e.t0.details&&e.t0.details.errors&&(o="".concat(o,". ").concat(JSON.stringify(e.t0.details.errors))),console.error("dfuse: ".concat(o)),e.abrupt("continue",17);case 13:if(c=r.cursor,!(i=r.transactions)||!i[0]){e.next=17;break}return e.delegateYield(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],i.forEach((function(e){var a=T(e,n);t.push.apply(t,Object(h.a)(a))})),e.next=4,t;case 4:case"end":return e.stop()}}),e)}))(),"t1",17);case 17:if(""!==c){e.next=1;break}case 18:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var D,z,I,A,_,F,C,P,M,q,L,W,J,Q,R,U=a(142),V=a.n(U),Y=function(e,t){return e?"green.".concat([[100,200,300,400,500][t]]):"red.".concat([[100,200,300,400,500][t]])},G=function(e){return"".concat("token-portfolio","-").concat(e)},X=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=localStorage.getItem(G(e));if(a){if(!t)return a;try{return JSON.parse(a)}catch(n){return a}}},H=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return localStorage.setItem(G(e),a?JSON.stringify(t):t)},K={precision:4,code:"EOS"},Z=(D=function(){function e(t){Object(m.a)(this,e),this.rootStore=void 0,Object(u.a)(this,"balance",z,this),Object(u.a)(this,"minBalanceFilter",I,this),Object(u.a)(this,"transferActions",A,this),Object(u.a)(this,"handleMinBalanceFilterSubmit",_,this),Object(u.a)(this,"fetchTokenInfo",F,this),Object(u.a)(this,"_fetchTransactions",C,this),Object(u.a)(this,"_fetchCurrentBalance",P,this),this.rootStore=t,this.minBalanceFilter=X("minBalanceFilter")||"0.01"}return Object(f.a)(e,[{key:"_getAccount",value:function(){return this.rootStore.userStore.accountName}},{key:"_checkAccount",value:function(){var e=this._getAccount();if(!e)throw new Error("Must enter an account name first");return e}},{key:"minBalance",get:function(){var e=0,t=this.balance.symbol;if(this.minBalanceFilter){var a=Math.pow(10,t.precision);e=Math.floor(Number.parseFloat(this.minBalanceFilter)*a)}return{amount:e,symbol:t}}},{key:"groupedTransfers",get:function(){var e=this,t=this._getAccount();if(!t||!this.balance)return{};var a=this.balance.amount,n=this.balance.symbol,r={},c=this.transferActions.sort((function(e,t){return t.blockNumber-e.blockNumber})),o=V()(c,(function(e){return e.trxId}));Object.entries(o).forEach((function(c,o){var i=Object(d.a)(c,2),l=i[0],s=i[1],u=new O.a("0"),m="",f=new O.a("0");if(s.forEach((function(e){var a=e.data.to===t,n=Object(v.decomposeAsset)(e.data.quantity).amount;u=a?u.plus(n):u.minus(n),n.abs().isGreaterThan(f)&&(f=n.abs(),m=a?e.data.from:e.data.to)})),0===o||u.abs().isGreaterThanOrEqualTo(e.minBalance.amount)){var b=Object(d.a)(s,1)[0];r[l]={trxId:b.trxId,blockNumber:b.blockNumber,timestamp:b.timestamp,deltaQuantity:{amount:u,symbol:n},balance:{amount:a,symbol:n},impact:0,party:m}}a=a.minus(u)}));var i=Object.values(r);return function(e){var t=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?function(e,t){return e.val-t.val}:function(e,t){return t.val-e.val}},a=e.filter((function(e){return e.val<0})).sort(t(!1)),n=e.filter((function(e){return e.val>=0})).sort(t(!0));return a.forEach((function(e,t){e.bucket=Math.floor(t/a.length*5)})),n.forEach((function(e,t){e.bucket=Math.floor(t/n.length*5)})),a.concat(n)}(i.map((function(e,t){return{index:t,val:e.deltaQuantity.amount.toNumber()}}))).forEach((function(e){i[e.index].impact=e.bucket})),r}},{key:"groupedTransfersDataPoints",get:function(){if(!this.balance)return[];var e=Math.pow(10,this.balance.symbol.precision);return Object.values(this.groupedTransfers).map((function(t){return{x:t.timestamp,y:t.balance.amount.toNumber()/e}}))}},{key:"groupedTransfersDates",get:function(){var e=this.groupedTransfersDataPoints;if(e.length<2)return[];var t=e[0].x,a=e[e.length-1].x,n=t.getTime()-a.getTime();return Array.from({length:7},(function(e,t){return new Date(a.getTime()+Math.floor(t*(n/6)))}))}},{key:"chartRange",get:function(){var e=this.groupedTransfersDataPoints.map((function(e){return e.y}));return[.5*Math.min.apply(Math,Object(h.a)(e)),1.05*Math.max.apply(Math,Object(h.a)(e))]}}]),e}(),z=Object(b.a)(D.prototype,"balance",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),I=Object(b.a)(D.prototype,"minBalanceFilter",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(b.a)(D.prototype,"transferActions",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.n.array([])}}),_=Object(b.a)(D.prototype,"handleMinBalanceFilterSubmit",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.minBalanceFilter=t,H("minBalanceFilter",t)}}}),Object(b.a)(D.prototype,"minBalance",[p.g],Object.getOwnPropertyDescriptor(D.prototype,"minBalance"),D.prototype),F=Object(b.a)(D.prototype,"fetchTokenInfo",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(Object(s.a)(l.a.mark((function t(){var a,n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetchCurrentBalance();case 2:a=t.sent,n=a.balance,r=a.lastIrreversibleBlockNum,e.balance=n,e.transferActions.replace([]),e._fetchTransactions(r);case 8:case"end":return t.stop()}}),t)}))))}}),C=Object(b.a)(D.prototype,"_fetchTransactions",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(function(){var t=Object(s.a)(l.a.mark((function t(a){var n,r,c,o,i,s,u,m,f,b,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e._checkAccount(),r=function(e){return e.receipt.receiver===n&&("eosio.token"===e.act.account&&"transfer"===e.act.name&&(e.act.data.from===n||e.act.data.to===n))},c=["receiver:".concat(n," account:eosio.token action:transfer"),a,r],o=!0,i=!1,t.prev=5,u=Object(g.a)(N(c[0],c[1],c[2]));case 7:return t.next=9,u.next();case 9:return m=t.sent,o=m.done,t.next=13,m.value;case 13:if(f=t.sent,o){t.next=22;break}if(p=f,e._getAccount()===n){t.next=18;break}return t.abrupt("break",22);case 18:(b=e.transferActions).push.apply(b,Object(h.a)(p));case 19:o=!0,t.next=7;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(5),i=!0,s=t.t0;case 28:if(t.prev=28,t.prev=29,o||null==u.return){t.next=33;break}return t.next=33,u.return();case 33:if(t.prev=33,!i){t.next=36;break}throw s;case 36:return t.finish(33);case 37:return t.finish(28);case 38:case"end":return t.stop()}}),t,null,[[5,24,28,38],[29,,33,37]])})));return function(e){return t.apply(this,arguments)}}())}}),P=Object(b.a)(D.prototype,"_fetchCurrentBalance",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(Object(s.a)(l.a.mark((function t(){var a,n,r,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.balance=void 0,a=e._checkAccount(),t.next=4,E("eosio.token","accounts",[a]);case 4:return n=t.sent,r=n.last_irreversible_block_num,c=n.tables[0].rows,o=new O.a("0"),c[0]&&(o=Object(v.decomposeAsset)(c[0].json.balance).amount),t.abrupt("return",{balance:{amount:o,symbol:K},lastIrreversibleBlockNum:r});case 10:case"end":return t.stop()}}),t)}))))}}),Object(b.a)(D.prototype,"groupedTransfers",[p.g],Object.getOwnPropertyDescriptor(D.prototype,"groupedTransfers"),D.prototype),Object(b.a)(D.prototype,"groupedTransfersDataPoints",[p.g],Object.getOwnPropertyDescriptor(D.prototype,"groupedTransfersDataPoints"),D.prototype),Object(b.a)(D.prototype,"groupedTransfersDates",[p.g],Object.getOwnPropertyDescriptor(D.prototype,"groupedTransfersDates"),D.prototype),Object(b.a)(D.prototype,"chartRange",[p.g],Object.getOwnPropertyDescriptor(D.prototype,"chartRange"),D.prototype),D),$=(M=function e(t){Object(m.a)(this,e),this.rootStore=void 0,Object(u.a)(this,"accountName",q,this),Object(u.a)(this,"networkName",L,this),Object(u.a)(this,"handleUserNameSubmit",W,this),Object(u.a)(this,"init",J,this),this.rootStore=t},q=Object(b.a)(M.prototype,"accountName",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),L=Object(b.a)(M.prototype,"networkName",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"mainnet"}}),W=Object(b.a)(M.prototype,"handleUserNameSubmit",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.accountName=t,H("accountName",t),e.rootStore.onNewAccount()}}}),J=Object(b.a)(M.prototype,"init",[p.f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return(Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.accountName=X("accountName")||"",e.accountName&&e.rootStore.onNewAccount();case 2:case"end":return t.stop()}}),t)}))))}}),M),ee=new(Q=function(){function e(){var t=this;Object(m.a)(this,e),Object(u.a)(this,"initialized",R,this),this.tokenStore=new Z(this),this.userStore=new $(this),this.onNewAccount=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.tokenStore.fetchTokenInfo();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error fetching token info:",e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))}return Object(f.a)(e,[{key:"init",value:function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userStore.init();case 2:this.initialized=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),R=Object(b.a)(Q.prototype,"initialized",[p.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q),te=r.a.createContext(ee),ae=function(e){var t=Object(n.useContext)(te);if(!t)throw new Error("storeContext does not have any value");return e(t)},ne=a(61),re=a(60),ce=a(572),oe=a(303),ie=a(143),le=a(139),se=a(555),ue=a(18),me=a(287),fe=a(556),be=a(291),pe=a(186),he=a(567),de=function(){var e=ae((function(e){return e.userStore})),t=Object(ie.a)(),a=t.handleSubmit,c=t.errors,o=t.register,i=Object(n.useState)(!1),l=Object(d.a)(i,2),s=(l[0],l[1]);return r.a.createElement(se.a,{w:"100%",h:"16",justifyContent:"center",alignItems:"center"},r.a.createElement(se.a,{w:"100%",maxW:"4xl",alignItems:"center",justifyContent:"space-between"},r.a.createElement(ue.a,{textTransform:"uppercase",letterSpacing:"tight",fontSize:"xl",fontWeight:"bold"},"Token Portfolio"),r.a.createElement("form",{onSubmit:a((function(t){s(!0),e.handleUserNameSubmit(t.name),s(!1)}))},r.a.createElement(me.a,{isInvalid:Boolean(c.name)},r.a.createElement(fe.a,null,r.a.createElement(be.a,{name:"name",placeholder:"account",w:"64",maxLength:13,autoFocus:!0,focusBorderColor:"teal.200",ref:o({validate:function(e){return!!Object(le.isName)(e)||"Not a valid EOSIO account name"}}),defaultValue:e.accountName}),r.a.createElement(pe.b,null,r.a.createElement(he.a,{variantColor:"teal","aria-label":"Search",fontSize:"20px",icon:"search",type:"submit"})))))))},ge=a(79),ve=a(565),ye=Object(ge.a)({},ve.a,{colors:Object(ge.a)({},ve.a.colors,{brand:{900:"#1a365d",800:"#153e75",700:"#2a69ac"}}),maxWidth:1280}),Oe=a(154),je=a(148),ke=a(77),xe=a(48),we=a(559),Ee=a(560),Se=a(571),Te=a(93),Ne=a(557),Be=a(558);function De(){var e=Object(je.a)(["\n  display: inline-block;\n  text-align: center;\n"]);return De=function(){return e},e}Object(xe.a)(ue.a)(De());var ze=Object(ke.a)((function(){var e=ae((function(e){return[e.userStore,e.tokenStore]})),t=Object(d.a)(e,2),a=(t[0],t[1]),c=Object(ie.a)(),o=c.handleSubmit,i=c.errors,l=c.register,s=Object(n.useState)(!1),u=Object(d.a)(s,2),m=(u[0],u[1]);return r.a.createElement(se.a,{flexDir:"column",alignItems:"center",w:"100%",mb:"8"},r.a.createElement(Ne.a,{as:"h4",fontSize:"lg",mb:"1"},"Filters"),r.a.createElement("form",{onSubmit:o((function(e){m(!0),a.handleMinBalanceFilterSubmit(e.minBalanceFilter),m(!1)}))},r.a.createElement(me.a,{isInvalid:Boolean(i.minBalanceFilter)},r.a.createElement(fe.a,null,r.a.createElement(Be.a,{children:"Min Balance"}),r.a.createElement(be.a,{name:"minBalanceFilter",placeholder:"0.01",w:"64",focusBorderColor:"teal.200",ref:l({validate:function(e){return/^\d*(\.\d+){0,1}$/.test(e)}}),defaultValue:a.minBalanceFilter}),r.a.createElement(pe.b,null,r.a.createElement(he.a,{variantColor:"teal","aria-label":"Apply Filter",fontSize:"20px",icon:"check",type:"submit"}))))))}));function Ie(){var e=Object(je.a)(["\n  display: inline-block;\n  text-align: center;\n"]);return Ie=function(){return e},e}var Ae=Object(xe.a)(ue.a)(Ie()),_e=function(e){var t=e.trx,a=Object(Oe.a)(e,["trx"]),n=!t.deltaQuantity.amount.isNegative();return r.a.createElement(we.a,Object.assign({py:"4",px:"6",backgroundColor:"gray.700"},a),r.a.createElement(Ae,{w:"48"},t.timestamp.toLocaleString()),r.a.createElement(Ae,{w:"32"},t.party),r.a.createElement(Ae,{w:"32",color:Y(n,t.impact)},Object(v.formatAsset)(t.deltaQuantity)),r.a.createElement(Ae,{w:"48",fontWeight:700},Object(v.formatAsset)(t.balance)),r.a.createElement(Ae,{w:"32"},r.a.createElement(Ee.a,{display:"flex",flexDir:"row",alignItems:"center",lineHeight:"1.5em",href:Object(v.formatBlockExplorerTransaction)("eosq")(t.trxId),isExternal:!0},r.a.createElement(Se.a,{backgroundColor:"transparent"},t.trxId.slice(0,4),"..",t.trxId.slice(-4)),r.a.createElement(Te.a,{name:"external-link",ml:"1"}))))},Fe=Object(ke.a)((function(){var e=ae((function(e){return[e.userStore,e.tokenStore]})),t=Object(d.a)(e,2),a=(t[0],t[1]);return r.a.createElement(se.a,{flexDir:"column",alignItems:"center",maxW:"100%",w:"6xl",marginX:"auto",marginY:"12"},r.a.createElement(Ne.a,{as:"h2",size:"xl",mb:"4"},"Your Transfers"),r.a.createElement(ze,null),r.a.createElement(we.b,{spacing:1,fontSize:"sm"},r.a.createElement(we.a,{py:"4",px:"6",textTransform:"uppercase"},r.a.createElement(Ae,{w:"48"},"Time"),r.a.createElement(Ae,{w:"32"},"Party"),r.a.createElement(Ae,{w:"32"},"\u0394 Balance"),r.a.createElement(Ae,{w:"48"},"Balance"),r.a.createElement(Ae,{w:"32"},"Transaction")),Object.values(a.groupedTransfers).map((function(e){return r.a.createElement(_e,{key:e.trxId,trx:e})}))))})),Ce=a(564),Pe=a(569),Me=a(561),qe=a(566),Le=a(568),We=a(570),Je=Object(ke.a)((function(e){var t=ae((function(e){return[e.tokenStore]})),a=Object(d.a)(t,1)[0],c=Object(ne.b)(),o=Object(n.useState)({zoomDomain:void 0,selectedDomain:void 0}),i=Object(d.a)(o,2),l=i[0],s=i[1],u=16*Number.parseInt(c.sizes["6xl"]);return r.a.createElement(se.a,{flexDir:"column",alignItems:"center",maxW:"100%",w:"6xl",height:480,marginX:"auto",marginTop:"12",marginBottom:"48"},r.a.createElement(Ce.a,{width:u,height:480,scale:{x:"time"},theme:Pe.a.material,domain:l.zoomDomain,padding:{left:100,right:50,top:50,bottom:50},domainPadding:{x:[10,10],y:[10,60]}},r.a.createElement(Me.a,{style:{data:{stroke:c.colors.teal[500]},labels:{fontSize:15,fill:c.colors.teal[500]}},data:a.groupedTransfersDataPoints,labels:function(e){return e.datum.y},labelComponent:r.a.createElement(qe.a,null)}),r.a.createElement(Le.a,{crossAxis:!0,style:{tickLabels:{fill:c.colors.gray[500],stroke:c.colors.gray[500],fontSize:16},axis:{stroke:c.colors.gray[700]},grid:{stroke:c.colors.gray[700]}}}),r.a.createElement(Le.a,{crossAxis:!0,dependentAxis:!0,style:{tickLabels:{fill:c.colors.teal[500],stroke:c.colors.teal[500],fontSize:16},axis:{stroke:c.colors.gray[700]},grid:{stroke:c.colors.gray[700]}}})),r.a.createElement(Ce.a,{padding:{top:0,left:50,right:50,bottom:30},width:600,height:90,scale:{x:"time"},theme:Pe.a.material,containerComponent:r.a.createElement(We.a,{responsive:!1,brushStyle:{stroke:"transparent",fill:c.colors.teal[200],fillOpacity:.2},brushDomain:l.selectedDomain,onBrushDomainChange:function(e){s(Object(ge.a)({},l,{zoomDomain:e}))}})},r.a.createElement(Le.a,{tickValues:a.groupedTransfersDates,tickFormat:function(e){return e.toLocaleDateString()},style:{tickLabels:{fill:c.colors.gray[500],stroke:c.colors.gray[500]}}}),r.a.createElement(Me.a,{style:{data:{stroke:c.colors.teal[500]}},data:a.groupedTransfersDataPoints})))})),Qe=function(e){var t=e.children;return r.a.createElement(te.Provider,{value:ee},t)},Re=Object(ke.a)((function(){var e=ae((function(e){return e}));return Object(n.useEffect)((function(){e||console.error("Rootstore not initialized yet."),e.init()}),[e]),r.a.createElement(Qe,null,r.a.createElement(ne.a,{theme:ye},r.a.createElement(re.b,null,r.a.createElement(re.a,null,r.a.createElement(ce.a,null),e.initialized?r.a.createElement(r.a.Fragment,null,r.a.createElement(de,null),r.a.createElement(Je,null),r.a.createElement(Fe,null)):r.a.createElement(oe.a,null)))))}));console.log("%c".concat("token-portfolio","@").concat("0.1.0"),"color: ".concat(ye.colors.teal[200],"; font-size: 12px;")),o.a.render(r.a.createElement(Re,null),document.getElementById("root"))}},[[307,1,2]]]);
//# sourceMappingURL=main.ebd247e0.chunk.js.map